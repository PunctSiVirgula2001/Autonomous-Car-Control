<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__i2_c__sensor_control_8c_source" xml:lang="en-US">
<title>I2C_sensorControl.c</title>
<indexterm><primary>src/I2C/I2C_sensorControl.c</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__i2_c__sensor_control_8c_source_1l00001"/>00001 <emphasis role="comment">/*</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00002"/>00002 <emphasis role="comment">&#32;*&#32;I2C_sensorControl.c</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00003"/>00003 <emphasis role="comment">&#32;*</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00004"/>00004 <emphasis role="comment">&#32;*&#32;&#32;Created&#32;on:&#32;14&#32;iun.&#32;2024</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00005"/>00005 <emphasis role="comment">&#32;*&#32;&#32;&#32;&#32;&#32;&#32;Author:&#32;racov</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00006"/>00006 <emphasis role="comment">&#32;*/</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00007"/>00007 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00008"/>00008 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__i2_c__sensor_control_8h">I2C_sensorControl.h</link>&quot;</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00009"/>00009 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00010"/><link linkend="_main_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">00010</link> QueueHandle_t&#32;<link linkend="__i2_c__sensor_control_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">I2C_commandQueue</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00011"/>00011 <emphasis role="keyword">extern</emphasis>&#32;QueueHandle_t&#32;<link linkend="__i2_c__sensor_control_8c_1ae0a77b0cf83af5755b406387533338e7">autonomousModeControlPixyQueue</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00012"/><link linkend="_main_8c_1a6a07f60157030f413311bca2bcd05350">00012</link> <emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1a6a07f60157030f413311bca2bcd05350">I2C_sensors_initiated</link>&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00013"/><link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">00013</link> <link linkend="_struct_i2_c___c_o_m_m_a_n_d">I2C_COMMAND</link>&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00014"/><link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">00014</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">speed_distance_sens_scaling</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00015"/><link linkend="__i2_c__sensor_control_8c_1add0400696ecb105e7b62b89241ff69ca">00015</link> <link linkend="_struct_pixy2_lines">Pixy2Lines</link>&#32;<link linkend="__i2_c__sensor_control_8c_1add0400696ecb105e7b62b89241ff69ca">lines</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00016"/>00016 <emphasis role="keyword">extern</emphasis>&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1aaa8698890fe268d44ede1ad83c711ffb">AutonomousMode</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00017"/>00017 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00018"/>00018 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00019"/><link linkend="__i2_c__temperature_sensor_8h_1a223d018b44dccfa36c89dcbcc975bef1">00019</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1a223d018b44dccfa36c89dcbcc975bef1">I2C_devices_task</link>(<emphasis role="keywordtype">void</emphasis>&#32;*pvParameters)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00020"/>00020 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;temp;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00021"/>00021 &#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1a6a07f60157030f413311bca2bcd05350">I2C_sensors_initiated</link>&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00022"/>00022 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00023"/>00023 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialize&#32;ESP32&#32;as&#32;master.</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00024"/>00024 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1a195e5504c89aeda3a53f31710e405623">I2C_master_init</link>();
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00025"/>00025 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00026"/>00026 &#32;&#32;&#32;&#32;ESP_LOGI(<emphasis role="stringliteral">&quot;I2C_sensors&quot;</emphasis>,&#32;<emphasis role="stringliteral">&quot;Sensors&#32;init&#32;start!&quot;</emphasis>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00027"/>00027 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Initialize&#32;sensors.</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00028"/>00028 &#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1a6a07f60157030f413311bca2bcd05350">I2C_sensors_initiated</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8c_1a634afb850adbac31a4c7bd552156d2e0">I2C_addAndInitialiseSensors</link>();
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00029"/>00029 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(<link linkend="__i2_c__sensor_control_8c_1a6a07f60157030f413311bca2bcd05350">I2C_sensors_initiated</link>&#32;==&#32;<emphasis role="keyword">false</emphasis>)
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00030"/>00030 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ESP_LOGI(<emphasis role="stringliteral">&quot;I2C_sensors&quot;</emphasis>,&#32;<emphasis role="stringliteral">&quot;Sensors&#32;init&#32;failed!&quot;</emphasis>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00031"/>00031 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00032"/>00032 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ESP_LOGI(<emphasis role="stringliteral">&quot;I2C_sensors&quot;</emphasis>,&#32;<emphasis role="stringliteral">&quot;Sensors&#32;successfully&#32;initiated!&quot;</emphasis>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00033"/>00033 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00034"/>00034 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Create&#32;structure&#32;for&#32;managing&#32;each&#32;sensor.</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00035"/>00035 &#32;&#32;&#32;&#32;<link linkend="_structsensor__t">sensor_t</link>&#32;sensors[]&#32;=&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00036"/>00036 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a74f1f96531b7d4446ef85782409dde7a">I2C_distance_sens1_dev_handle</link>,&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a74556c047e53ea5ae5d205eb0ea15d88">I2C_distance_sens_1_mux</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea8bdc4a1b37a7ae051a37b3a0c7f1da00">distance_sens1</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea8bdc4a1b37a7ae051a37b3a0c7f1da00">distance_sens1</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>},
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00037"/>00037 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812ae0cd12c1b1a40d21a031668e96790741">I2C_distance_sens2_dev_handle</link>,&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a366361b6c13f8f3072a1ffac0d249d90">I2C_distance_sens_2_mux</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea3256cb98ccbbe742388ee16237c7859b">distance_sens2</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea3256cb98ccbbe742388ee16237c7859b">distance_sens2</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>},
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00038"/>00038 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a86eeffe86d3fb2233b77d782614d0bf4">I2C_adxl345_sens_dev_handle</link>,&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a7b6b89c137d67e25714751e50d721c6b">I2C_adxl345_sens_mux</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea96326bbbfbd898bbd0b50617db47528c">adxl_acc</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea96326bbbfbd898bbd0b50617db47528c">adxl_acc</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>},
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00039"/>00039 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a1ddd366fdf84b23af7a0f847a2ff0d93">I2C_pixy2_dev_handle</link>,&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a08bdbe34ce8659d94b4f5e182a43d125">I2C_pixy2_camera_mux</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea5cf7d6de0e15f0c2defea2a399035379">pixy2</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9ea5cf7d6de0e15f0c2defea2a399035379">pixy2</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>},
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a2b08684eb17f8e8bda63177ef74e255c">I2C_temp_sens_dev_handle</link>,&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6ad7b0bc85a1daf7e9a20727d4740adb24">I2C_temp_sens_mux</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9eab5d1317da0789d76987df6c4c8a5add4">temp_sens</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1ad4fa48dd63f483f21c3767c3665bbe9eab5d1317da0789d76987df6c4c8a5add4">temp_sens</link>,&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00041"/>00041 &#32;&#32;&#32;&#32;};
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00042"/>00042 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00043"/>00043 &#32;&#32;&#32;&#32;<link linkend="_struct_i2_c___c_o_m_m_a_n_d">I2C_COMMAND</link>&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>&#32;=&#32;{0,&#32;0,&#32;0};
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00044"/>00044 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00045"/>00045 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;sensor_count&#32;=&#32;<emphasis role="keyword">sizeof</emphasis>(sensors)&#32;/&#32;<emphasis role="keyword">sizeof</emphasis>(<link linkend="_structsensor__t">sensor_t</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00046"/>00046 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">size_t</emphasis>&#32;current_sensor_index&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00047"/>00047 &#32;&#32;&#32;&#32;<link linkend="_structsensor__t">sensor_t</link>&#32;*current_sensor&#32;=&#32;&amp;sensors[current_sensor_index];
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00048"/>00048 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00049"/>00049 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(1)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00050"/>00050 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00051"/>00051 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOG(&quot;I2C_TASK&quot;,&quot;%u&#32;ms&quot;,pdTICKS_TO_MS(xTaskGetTickCount()));</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Skip&#32;sensors&#32;with&#32;0&#32;tokens</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(current_sensor-&gt;<link linkend="_structsensor__t_1a8678d56e5a049e7ac88ea9d448cf6307">tokens</link>&#32;==&#32;0)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor_index&#32;=&#32;(current_sensor_index&#32;+&#32;1)&#32;%&#32;sensor_count;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00055"/>00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor&#32;=&#32;&amp;sensors[current_sensor_index];
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00056"/>00056 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00057"/>00057 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;uint16_t&#32;readValSensor_dist1_prev&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00058"/>00058 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">double</emphasis>&#32;readValSensor_dist1_final&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00059"/>00059 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00060"/>00060 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;uint16_t&#32;readValSensor_dist2_prev&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00061"/>00061 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">double</emphasis>&#32;readValSensor_dist2_final&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00062"/>00062 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">switch</emphasis>&#32;(current_sensor-&gt;<link linkend="_structsensor__t_1a72d0c88c8a136c777fb251336bedcce9">state</link>)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00064"/>00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00065"/>00065 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1aef48213de5230add491038aa4c4eb05a">I2C_select_multiplexer_channel</link>(current_sensor-&gt;<link linkend="_structsensor__t_1a4a8533c77f964d99f764ca0b3aa5231b">mux</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00066"/>00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;vTaskDelay(pdMS_TO_TICKS(5));&#32;<emphasis role="comment">//&#32;Allow&#32;for&#32;multiplexer&#32;switch</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a72d0c88c8a136c777fb251336bedcce9">state</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a5fe6c45c6b2f94ff82e9f440bae7f019">SENSOR_READING</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00069"/>00069 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a5fe6c45c6b2f94ff82e9f440bae7f019">SENSOR_READING</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">switch</emphasis>&#32;(current_sensor-&gt;<link linkend="_structsensor__t_1a4a8533c77f964d99f764ca0b3aa5231b">mux</link>)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00072"/>00072 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a74556c047e53ea5ae5d205eb0ea15d88">I2C_distance_sens_1_mux</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00073"/>00073 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;uint16_t&#32;readValSensor1;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00074"/>00074 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Read&#32;new&#32;sensor&#32;value</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor1&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1a852c08c9a46bddf494f7ea798ff66b49">VL53L0X_readRangeContinuousMillimeters</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a74f1f96531b7d4446ef85782409dde7a">I2C_distance_sens1_dev_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Apply&#32;low-pass&#32;filter</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor_dist1_final&#32;=&#32;readValSensor1;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00078"/>00078 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//readValSensor_dist1_final&#32;=&#32;ALPHA_VL53L0X&#32;*&#32;(double)readValSensor1&#32;+&#32;(1&#32;-&#32;ALPHA_VL53L0X)&#32;*&#32;(double)readValSensor_dist1_prev;</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00079"/>00079 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Update&#32;the&#32;previous&#32;value&#32;for&#32;the&#32;next&#32;iteration</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00080"/>00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//readValSensor_dist1_prev&#32;=&#32;readValSensor1;</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00081"/>00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Make&#32;a&#32;decision</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00082"/>00082 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00083"/>00083 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__network_8h_1a979168b4c86e45871c79ddc820763652">sendCommandApp</link>(<link linkend="__network_8h_1a57a739fb3d417e5abded6e0ac98c115ba1397744e3bab2c358b7250d459aef0f4">DistSensFw</link>,&#32;(<emphasis role="keywordtype">double</emphasis>*)&amp;readValSensor_dist1_final,&#32;<link linkend="__network_8h_1a05e8c8420da1c24552059209fc234b2fa33465d1d419b1074fb259ef444609e92">DOUBLE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00084"/>00084 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;countSendStop_sens1&#32;=&#32;0,countSendStart_sens1&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00085"/>00085 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(readValSensor_dist1_final&#32;&lt;&#32;(<link linkend="__i2_c__distance_sensor_8h_1ac8b4488eb685a8acd9d9d2fe562de857">Threshold_dist</link>&#32;*&#32;<link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">speed_distance_sens_scaling</link>)&#32;&amp;&amp;&#32;countSendStop_sens1&#32;==&#32;0)
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00086"/>00086 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00087"/>00087 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStop_sens1++;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00088"/>00088 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStart_sens1=0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00089"/>00089 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a5ff35ccbaea55a46f1f7306f278c552f">command</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1aab3c5ccae58c975d0afd2e876992ba53a975499341bc3acadc20fde0e2e00f4e1">I2C_STOP_MOTOR</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00090"/>00090 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a967ac9a6d0fe08ad2cafe556118c3c16">commandValue</link>&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00091"/>00091 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1af093706b79cdd89f26148de82c235225">sendingSensor</link>&#32;=&#32;<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a74f1f96531b7d4446ef85782409dde7a">I2C_distance_sens1_dev_handle</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00092"/>00092 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">I2C_commandQueue</link>,&amp;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>,pdMS_TO_TICKS(5000));
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00093"/>00093 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;&quot;,&#32;&quot;Sent&#32;STOP&#32;for&#32;forward&#32;\n&quot;);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00094"/>00094 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00095"/>00095 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>&#32;(countSendStart_sens1&#32;==&#32;0&#32;&amp;&amp;&#32;readValSensor_dist1_final&#32;&gt;=&#32;(<link linkend="__i2_c__distance_sensor_8h_1ac8b4488eb685a8acd9d9d2fe562de857">Threshold_dist</link>&#32;*&#32;<link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">speed_distance_sens_scaling</link>))
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00096"/>00096 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00097"/>00097 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStop_sens1=0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00098"/>00098 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStart_sens1++;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a5ff35ccbaea55a46f1f7306f278c552f">command</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1aab3c5ccae58c975d0afd2e876992ba53aac41faa6d3b03bb6bd35322356468386">I2C_START_MOTOR</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00100"/>00100 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a967ac9a6d0fe08ad2cafe556118c3c16">commandValue</link>&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00101"/>00101 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1af093706b79cdd89f26148de82c235225">sendingSensor</link>&#32;=&#32;<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a74f1f96531b7d4446ef85782409dde7a">I2C_distance_sens1_dev_handle</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00102"/>00102 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">I2C_commandQueue</link>,&amp;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>,pdMS_TO_TICKS(5000));
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00103"/>00103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;&quot;,&#32;&quot;Sent&#32;START&#32;for&#32;forward&#32;\n&quot;);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00105"/>00105 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Log&#32;the&#32;filtered&#32;value</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00107"/>00107 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;I2C&quot;,&#32;&quot;Range1:&#32;[&#32;%.2lf&#32;]&quot;,&#32;readValSensor_dist1_final);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00108"/>00108 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//vTaskDelay(pdMS_TO_TICKS(50));&#32;//&#32;Allow&#32;for&#32;multiplexer&#32;switch</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00109"/>00109 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00110"/>00110 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00111"/>00111 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a366361b6c13f8f3072a1ffac0d249d90">I2C_distance_sens_2_mux</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00112"/>00112 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;uint16_t&#32;readValSensor2;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00113"/>00113 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor2&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1a852c08c9a46bddf494f7ea798ff66b49">VL53L0X_readRangeContinuousMillimeters</link>(current_sensor-&gt;<link linkend="_structsensor__t_1a4e96223c314d688cc40a539d4e363258">device_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00114"/>00114 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor_dist2_final&#32;=&#32;ALPHA_VL53L0X&#32;*&#32;(double)readValSensor2&#32;+&#32;(1&#32;-&#32;ALPHA_VL53L0X)&#32;*&#32;(double)readValSensor_dist2_prev;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Update&#32;the&#32;previous&#32;value&#32;for&#32;the&#32;next&#32;iteration</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00115"/>00115 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor_dist2_prev&#32;=&#32;readValSensor2;</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00116"/>00116 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;readValSensor_dist2_final&#32;=&#32;readValSensor2;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00117"/>00117 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__network_8h_1a979168b4c86e45871c79ddc820763652">sendCommandApp</link>(<link linkend="__network_8h_1a57a739fb3d417e5abded6e0ac98c115bad0ea62e65fa39f2c36d6c5267af85178">DistSensBw</link>,&#32;(<emphasis role="keywordtype">double</emphasis>*)&amp;readValSensor_dist2_final,&#32;<link linkend="__network_8h_1a05e8c8420da1c24552059209fc234b2fa33465d1d419b1074fb259ef444609e92">DOUBLE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00118"/>00118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;countSendStop_sens2&#32;=&#32;0,countSendStart_sens2&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00119"/>00119 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(readValSensor_dist2_final&#32;&lt;&#32;(<link linkend="__i2_c__distance_sensor_8h_1ac8b4488eb685a8acd9d9d2fe562de857">Threshold_dist</link>&#32;*&#32;<link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">speed_distance_sens_scaling</link>)&#32;&amp;&amp;&#32;countSendStop_sens2&#32;==&#32;0)
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00120"/>00120 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00121"/>00121 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStop_sens2++;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00122"/>00122 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStart_sens2=0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00123"/>00123 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a5ff35ccbaea55a46f1f7306f278c552f">command</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1aab3c5ccae58c975d0afd2e876992ba53a975499341bc3acadc20fde0e2e00f4e1">I2C_STOP_MOTOR</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00124"/>00124 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a967ac9a6d0fe08ad2cafe556118c3c16">commandValue</link>&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00125"/>00125 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1af093706b79cdd89f26148de82c235225">sendingSensor</link>&#32;=&#32;<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812ae0cd12c1b1a40d21a031668e96790741">I2C_distance_sens2_dev_handle</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00126"/>00126 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">I2C_commandQueue</link>,&amp;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>,-1);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00127"/>00127 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;&quot;,&#32;&quot;Sent&#32;STOP&#32;for&#32;backward&#32;\n&quot;);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00128"/>00128 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00129"/>00129 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<emphasis role="keywordflow">if</emphasis>&#32;(countSendStart_sens2&#32;==&#32;0&#32;&amp;&amp;&#32;readValSensor_dist2_final&#32;&gt;=&#32;(<link linkend="__i2_c__distance_sensor_8h_1ac8b4488eb685a8acd9d9d2fe562de857">Threshold_dist</link>&#32;*&#32;<link linkend="__i2_c__sensor_control_8c_1a798a61f7f4a9d94f40e4a0c59bece8a0">speed_distance_sens_scaling</link>))
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00130"/>00130 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00131"/>00131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStop_sens2=0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00132"/>00132 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;countSendStart_sens2++;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00133"/>00133 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a5ff35ccbaea55a46f1f7306f278c552f">command</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1aab3c5ccae58c975d0afd2e876992ba53aac41faa6d3b03bb6bd35322356468386">I2C_START_MOTOR</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00134"/>00134 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1a967ac9a6d0fe08ad2cafe556118c3c16">commandValue</link>&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00135"/>00135 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>.<link linkend="_struct_i2_c___c_o_m_m_a_n_d_1af093706b79cdd89f26148de82c235225">sendingSensor</link>&#32;=&#32;<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812ae0cd12c1b1a40d21a031668e96790741">I2C_distance_sens2_dev_handle</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00136"/>00136 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ad6d46a9e7610ddf0423e1a5e2e9bfc4f">I2C_commandQueue</link>,&amp;<link linkend="__i2_c__sensor_control_8c_1af8709299f1795dd960e64b0f618534cc">i2c_command</link>,-1);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00137"/>00137 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00138"/>00138 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Log&#32;the&#32;filtered&#32;value</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00139"/>00139 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;I2C&quot;,&#32;&quot;Range2:&#32;[&#32;%.2lf&#32;]&quot;,&#32;readValSensor_dist2_final);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00140"/>00140 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00141"/>00141 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00142"/>00142 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a7b6b89c137d67e25714751e50d721c6b">I2C_adxl345_sens_mux</link>:&#32;<emphasis role="comment">//&#32;if</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00143"/>00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;x,&#32;y,&#32;z;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00144"/>00144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">double</emphasis>&#32;roll_init_offset&#32;=&#32;0,&#32;pitch_init_offset&#32;=&#32;0,&#32;count&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00145"/>00145 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;init_offset&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00146"/>00146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__accelerometer_sensor_8h_1aeac395349fd0cb9b64e9dba9799e64e9">I2C_read_adxl345_data</link>(current_sensor-&gt;<link linkend="_structsensor__t_1a4e96223c314d688cc40a539d4e363258">device_handle</link>,&#32;&amp;x,&#32;&amp;y,&#32;&amp;z);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00147"/>00147 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00148"/>00148 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Calculate&#32;roll&#32;and&#32;pitch</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00149"/>00149 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;roll&#32;=&#32;atan2(y,&#32;sqrt(x&#32;*&#32;x&#32;+&#32;z&#32;*&#32;z))&#32;*&#32;180.0&#32;/&#32;M_PI;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00150"/>00150 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;pitch&#32;=&#32;atan2(-x,&#32;sqrt(y&#32;*&#32;y&#32;+&#32;z&#32;*&#32;z))&#32;*&#32;180.0&#32;/&#32;M_PI;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00151"/>00151 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">double</emphasis>&#32;roll_prev=0,&#32;pitch_prev=0,&#32;roll_final&#32;=&#32;0,&#32;pitch_final&#32;=&#32;0;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00152"/>00152 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(init_offset&#32;==&#32;<emphasis role="keyword">false</emphasis>)
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00153"/>00153 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00154"/>00154 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;count++;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00155"/>00155 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(count&lt;6)
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00156"/>00156 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00157"/>00157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;init_offset&#32;=&#32;<emphasis role="keyword">true</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00158"/>00158 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;roll_init_offset&#32;=&#32;roll;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00159"/>00159 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pitch_init_offset&#32;=&#32;pitch;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00160"/>00160 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00161"/>00161 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00162"/>00162 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;roll&#32;-=roll_init_offset;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00163"/>00163 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pitch&#32;-=pitch_init_offset;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00164"/>00164 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00165"/>00165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">/*&#32;Apply&#32;low&#32;pass&#32;filter&#32;*/</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00166"/>00166 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;roll_final&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1a255a3fdcc682edd0185bedde151204d8">ALPHA_ADXL</link>&#32;*&#32;(double)roll&#32;+&#32;(1&#32;-&#32;<link linkend="__i2_c__distance_sensor_8h_1a255a3fdcc682edd0185bedde151204d8">ALPHA_ADXL</link>)&#32;*&#32;(double)roll_prev;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Update&#32;the&#32;previous&#32;value&#32;for&#32;the&#32;next&#32;iteration</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00167"/>00167 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;roll_prev&#32;=&#32;roll;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00168"/>00168 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00169"/>00169 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pitch_final&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1a255a3fdcc682edd0185bedde151204d8">ALPHA_ADXL</link>&#32;*&#32;(double)pitch&#32;+&#32;(1&#32;-&#32;<link linkend="__i2_c__distance_sensor_8h_1a255a3fdcc682edd0185bedde151204d8">ALPHA_ADXL</link>)&#32;*&#32;(double)pitch_prev;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Update&#32;the&#32;previous&#32;value&#32;for&#32;the&#32;next&#32;iteration</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00170"/>00170 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pitch_prev&#32;=&#32;pitch;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00171"/>00171 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00172"/>00172 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;I2C&quot;,&#32;&quot;Orientation&#32;roll=%lf&#32;pitch=%lf&#32;&quot;,&#32;roll_final,&#32;pitch_final);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00173"/>00173 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00174"/>00174 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__network_8h_1a979168b4c86e45871c79ddc820763652">sendCommandApp</link>(<link linkend="__network_8h_1a57a739fb3d417e5abded6e0ac98c115ba1887b44606444dfa414ff58bbf3df2d8">ADXL_ROLL</link>,&#32;(<emphasis role="keywordtype">double</emphasis>*)&amp;roll_final,&#32;<link linkend="__network_8h_1a05e8c8420da1c24552059209fc234b2fa33465d1d419b1074fb259ef444609e92">DOUBLE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00175"/>00175 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__network_8h_1a979168b4c86e45871c79ddc820763652">sendCommandApp</link>(<link linkend="__network_8h_1a57a739fb3d417e5abded6e0ac98c115ba2943602fbb81a3e04ce7721b6c0833dd">ADXL_PITCH</link>,&#32;(<emphasis role="keywordtype">double</emphasis>*)&amp;pitch_final,&#32;<link linkend="__network_8h_1a05e8c8420da1c24552059209fc234b2fa33465d1d419b1074fb259ef444609e92">DOUBLE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00176"/>00176 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00177"/>00177 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00178"/>00178 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00179"/>00179 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6a08bdbe34ce8659d94b4f5e182a43d125">I2C_pixy2_camera_mux</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00180"/>00180 <emphasis role="preprocessor">#if&#32;(PIXY_DETECTION&#32;==&#32;ON)</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00181"/>00181 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_vector">Vector</link>&#32;goodVecLeft&#32;=&#32;{0};
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00182"/>00182 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_vector">Vector</link>&#32;&#32;goodVecRight&#32;=&#32;{0};
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00183"/>00183 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_structpixy2_commands">pixy2Commands</link>&#32;commandAutonomous;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00184"/>00184 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;left&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00185"/>00185 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;right&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00186"/>00186 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__camera_sensor_8h_1a59aa0718e545daa3e789822a7083071a">getPixy2Lines</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a1ddd366fdf84b23af7a0f847a2ff0d93">I2C_pixy2_dev_handle</link>,&#32;<link linkend="__i2_c__camera_sensor_8h_1ab76fef93704abe0ec57d1ba3ae0b6be9a7228fe4cb5769659b95c27b8c7470d0e">LINE_VECTOR</link>&#32;,&#32;<emphasis role="keyword">true</emphasis>,&#32;&amp;<link linkend="__i2_c__sensor_control_8c_1add0400696ecb105e7b62b89241ff69ca">lines</link>);&#32;<emphasis role="comment">//&#32;Get&#32;all&#32;features&#32;(vectors,&#32;intersections,&#32;barcodes)&#32;with&#32;wait</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00187"/>00187 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;left&#32;=&#32;<link linkend="__i2_c__camera_sensor_8h_1a159c619bbd072d296d8caf684332b02a">getBestVectorLeft</link>(&amp;<link linkend="__i2_c__sensor_control_8c_1add0400696ecb105e7b62b89241ff69ca">lines</link>,&#32;&amp;goodVecLeft);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00188"/>00188 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;right&#32;=&#32;<link linkend="__i2_c__camera_sensor_8h_1a7a16c5ef87bf82cd88751462ced8c749">getBestVectorRight</link>(&amp;<link linkend="__i2_c__sensor_control_8c_1add0400696ecb105e7b62b89241ff69ca">lines</link>,&#32;&amp;goodVecRight);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00189"/>00189 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__camera_sensor_8h_1ae51dba7e896d5485d4aaf8a4247438bb">computeSpeedAndSteer</link>(goodVecLeft,&#32;goodVecRight,&#32;left,&#32;right,&#32;&amp;commandAutonomous);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00190"/>00190 <emphasis role="keywordflow">if</emphasis>(<link linkend="__i2_c__sensor_control_8c_1aaa8698890fe268d44ede1ad83c711ffb">AutonomousMode</link>&#32;==&#32;<emphasis role="keyword">true</emphasis>){
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00191"/>00191 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ae0a77b0cf83af5755b406387533338e7">autonomousModeControlPixyQueue</link>,&#32;&amp;commandAutonomous.<link linkend="_structpixy2_commands_1a6bab39ce3ec27c60ca9b440de6cc5e1c">computedSpeedSetpoint</link>,&#32;portMAX_DELAY)&#32;!=&#32;pdPASS)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00192"/>00192 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ESP_LOGE(<emphasis role="stringliteral">&quot;Error&#32;uart&quot;</emphasis>,&#32;<emphasis role="stringliteral">&quot;Unable&#32;to&#32;send&#32;to&#32;queue&quot;</emphasis>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00193"/>00193 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00194"/>00194 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(xQueueSend(<link linkend="__i2_c__sensor_control_8c_1ae0a77b0cf83af5755b406387533338e7">autonomousModeControlPixyQueue</link>,&#32;&amp;commandAutonomous.<link linkend="_structpixy2_commands_1ac5ecf9eb16163cc0d3b89d49ae9d2838">computedSteerSetpoint</link>,&#32;portMAX_DELAY)&#32;!=&#32;pdPASS)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00195"/>00195 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ESP_LOGE(<emphasis role="stringliteral">&quot;Error&#32;uart&quot;</emphasis>,&#32;<emphasis role="stringliteral">&quot;Unable&#32;to&#32;send&#32;to&#32;queue&quot;</emphasis>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00196"/>00196 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00197"/>00197 }
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00198"/>00198 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00199"/>00199 <emphasis role="preprocessor">#endif</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00200"/>00200 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00201"/>00201 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00202"/>00202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__common_8h_1a70c4c5f41ff220dd7e6a2819a3bcb1c6ad7b0bc85a1daf7e9a20727d4740adb24">I2C_temp_sens_mux</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00203"/>00203 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__i2_c__temperature_sensor_8h_1adb1e5f7b5ee5e6c3f2263b6e600603b5">I2C_read_temperature</link>(&amp;temp);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00204"/>00204 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//ESP_LOGI(&quot;I2C&quot;,&#32;&quot;Temp:&#32;[&#32;%lf&#32;]&quot;,&#32;temp);</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00205"/>00205 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__network_8h_1a979168b4c86e45871c79ddc820763652">sendCommandApp</link>(<link linkend="__network_8h_1a57a739fb3d417e5abded6e0ac98c115bac4ae6787ff1d8b2d1cf0ae9aa696e56c">TEMPERATURE</link>,&#32;(<emphasis role="keywordtype">double</emphasis>*)&amp;temp,&#32;<link linkend="__network_8h_1a05e8c8420da1c24552059209fc234b2fa33465d1d419b1074fb259ef444609e92">DOUBLE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00206"/>00206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00207"/>00207 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00208"/>00208 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">default</emphasis>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00209"/>00209 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00210"/>00210 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00211"/>00211 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a72d0c88c8a136c777fb251336bedcce9">state</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718ac785071fd2b2091f55ca6915a58a2e56">SENSOR_READY</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00212"/>00212 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00213"/>00213 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00214"/>00214 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">case</emphasis>&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718ac785071fd2b2091f55ca6915a58a2e56">SENSOR_READY</link>:
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00215"/>00215 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(--current_sensor-&gt;<link linkend="_structsensor__t_1a67563a7a98e4a32c293a8b35eece073b">tokens_remaining</link>&#32;==&#32;0)&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00216"/>00216 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a67563a7a98e4a32c293a8b35eece073b">tokens_remaining</link>&#32;=&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a8678d56e5a049e7ac88ea9d448cf6307">tokens</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a72d0c88c8a136c777fb251336bedcce9">state</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor_index&#32;=&#32;(current_sensor_index&#32;+&#32;1)&#32;%&#32;sensor_count;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00219"/>00219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor&#32;=&#32;&amp;sensors[current_sensor_index];
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00220"/>00220 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00221"/>00221 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current_sensor-&gt;<link linkend="_structsensor__t_1a72d0c88c8a136c777fb251336bedcce9">state</link>&#32;=&#32;<link linkend="__i2_c__sensor_control_8h_1a085fb31f39314038a5dc035bb740c718a9975a8a9955ad85474b858ac0b25dfab">SENSOR_IDLE</link>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00222"/>00222 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00223"/>00223 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00224"/>00224 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00225"/>00225 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;vTaskDelay(pdMS_TO_TICKS(1));
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00226"/>00226 &#32;&#32;&#32;&#32;}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00227"/>00227 }
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00228"/>00228 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00229"/>00229 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00230"/><link linkend="__i2_c__sensor_control_8h_1a634afb850adbac31a4c7bd552156d2e0">00230</link> <emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1a634afb850adbac31a4c7bd552156d2e0">I2C_addAndInitialiseSensors</link>()
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00231"/>00231 {
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00232"/>00232 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1a793ef527029215fa4b7539adcc14e5e0">config_rst_pin_i2c_mux</link>();&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;config&#32;rst&#32;pin&#32;for&#32;the&#32;mux</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00233"/>00233 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1a0ac33d5cead56645b2d38faf5ff80e05">rst_pin_i2c_mux_off</link>();&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;rst&#32;pin&#32;on</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00234"/>00234 &#32;&#32;&#32;&#32;vTaskDelay(pdMS_TO_TICKS(2000));
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00235"/>00235 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1a0606cd7138b8af0f8a5b55f87d85849e">rst_pin_i2c_mux_on</link>();&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;rst&#32;pin&#32;on</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00236"/>00236 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00237"/>00237 &#32;&#32;&#32;&#32;<emphasis role="comment">//Add&#32;sensors</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00238"/>00238 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1ab80632e89563cc7cffa2bd9b6f301fcd">I2C_add_device</link>(<link linkend="__i2_c__common_8h_1a95a542263fbf01ce81beb07972a223b9a151002e2e300f340ce5a5b83ee443594">I2C_mux_addr</link>);<emphasis role="comment">//&#32;add&#32;the&#32;multiplexer&#32;to&#32;the&#32;I2C&#32;bus</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00239"/>00239 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1ab80632e89563cc7cffa2bd9b6f301fcd">I2C_add_device</link>(<link linkend="__i2_c__common_8h_1a95a542263fbf01ce81beb07972a223b9a908ba691106cd1ed595bd7418581ed49">I2C_temp_sens_addr</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00240"/>00240 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1ab80632e89563cc7cffa2bd9b6f301fcd">I2C_add_device</link>(<link linkend="__i2_c__common_8h_1a95a542263fbf01ce81beb07972a223b9adea9b3d7f55d5310d0799a2692ed572b">I2C_distance_sens_addr</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00241"/>00241 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1ab80632e89563cc7cffa2bd9b6f301fcd">I2C_add_device</link>(<link linkend="__i2_c__common_8h_1a95a542263fbf01ce81beb07972a223b9a34fad3dd3a58959b3665dc8725c6a3b8">I2C_adxl345_sens_addr</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00242"/>00242 &#32;&#32;&#32;&#32;<link linkend="__i2_c__common_8h_1ab80632e89563cc7cffa2bd9b6f301fcd">I2C_add_device</link>(<link linkend="__i2_c__common_8h_1a95a542263fbf01ce81beb07972a223b9a4601c56c5c7a2bf4090ab788d19a167b">I2C_pixy2_camera_addr</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00243"/>00243 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00244"/>00244 &#32;&#32;&#32;&#32;<emphasis role="comment">//Check&#32;Pixy2&#32;camera&#32;version</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00245"/>00245 &#32;&#32;&#32;&#32;<link linkend="__i2_c__camera_sensor_8h_1a017600a7956da0f432bbd877932f6ac2">requestPixy2Version</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a1ddd366fdf84b23af7a0f847a2ff0d93">I2C_pixy2_dev_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00246"/>00246 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00247"/>00247 &#32;&#32;&#32;&#32;<emphasis role="comment">//Init&#32;sensors</emphasis>
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00248"/>00248 &#32;&#32;&#32;&#32;<link linkend="__i2_c__accelerometer_sensor_8h_1af4369ee1e11eacb96049536d1b18a94e">I2C_adxl345_init</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a86eeffe86d3fb2233b77d782614d0bf4">I2C_adxl345_sens_dev_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00249"/>00249 &#32;&#32;&#32;&#32;<link linkend="__i2_c__accelerometer_sensor_8h_1a5daa89461a8c123f61a7e7e89a799bb2">I2C_adxl345_setRate</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a86eeffe86d3fb2233b77d782614d0bf4">I2C_adxl345_sens_dev_handle</link>,&#32;<link linkend="__i2_c__accelerometer_sensor_8h_1ac8af332c74b5b3043d69274f6000220e">ADXL1345_READ_RATE</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00250"/>00250 &#32;&#32;&#32;&#32;<link linkend="__i2_c__temperature_sensor_8h_1ab6eab86afbe85c747fb125447b03042a">I2C_temperatureSensor_trigger_measurement</link>();
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00251"/>00251 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;dist_sens_init&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1acca8dcfdeb3dc0146dbc884e9daae43b">VL53L0X_Init</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812ae0cd12c1b1a40d21a031668e96790741">I2C_distance_sens2_dev_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00252"/>00252 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>(dist_sens_init&#32;==&#32;<emphasis role="keyword">false</emphasis>)&#32;{vTaskDelay(pdMS_TO_TICKS(50));}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00253"/>00253 &#32;&#32;&#32;&#32;dist_sens_init&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00254"/>00254 &#32;&#32;&#32;&#32;dist_sens_init&#32;=&#32;<link linkend="__i2_c__distance_sensor_8h_1acca8dcfdeb3dc0146dbc884e9daae43b">VL53L0X_Init</link>(<link linkend="__i2_c__common_8h_1a1aec57033a8a180b854b479b31a7a812a74f1f96531b7d4446ef85782409dde7a">I2C_distance_sens1_dev_handle</link>);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00255"/>00255 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>(dist_sens_init&#32;==&#32;<emphasis role="keyword">false</emphasis>)&#32;{vTaskDelay(pdMS_TO_TICKS(50));}
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00256"/>00256 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00257"/>00257 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">true</emphasis>;
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00258"/>00258 }
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00259"/>00259 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00260"/><link linkend="__i2_c__sensor_control_8h_1af25a3b4136659e2a41e7012d181ca9ad">00260</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__i2_c__sensor_control_8c_1af25a3b4136659e2a41e7012d181ca9ad">start_I2C_devices_task</link>()
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00261"/>00261 {
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00262"/>00262 &#32;&#32;&#32;&#32;xTaskCreatePinnedToCore(<link linkend="__i2_c__sensor_control_8c_1a223d018b44dccfa36c89dcbcc975bef1">I2C_devices_task</link>,&#32;<emphasis role="stringliteral">&quot;I2C_devices_task&quot;</emphasis>,&#32;4096,&#32;NULL,&#32;7,&#32;NULL,&#32;0);
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00263"/>00263 }
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00264"/>00264 
<anchor xml:id="__i2_c__sensor_control_8c_source_1l00265"/>00265 
</programlisting></section>
